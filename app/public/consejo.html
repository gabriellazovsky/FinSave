<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title data-i18n="app.title">FinSave ‚Äì Consejos Financieros</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="consejo.css">
    <link rel="icon" href="favicon.png" type="image/png">
</head>
<body class="categoria-ahorro">

<header class="w-full bg-white shadow-sm">
    <nav class="container mx-auto flex justify-between items-center px-4 py-3">
        <a href="persona.html" class="hover:text-blue-600 font-semibold" data-i18n="back">‚Üê Volver</a>
        <h1 class="text-xl font-bold text-gray-800" data-i18n="helpCenter">Centro Educativo</h1>
        <div class="ml-4 relative group" title="Activa modo oscuro/claro">
            <input type="checkbox" class="checkbox" id="checkbox">
            <label for="checkbox" class="checkbox-label">
                <i class="fas fa-moon">‚òÄÔ∏è</i>
                <i class="fas fa-sun">üåô</i>
                <span class="ball"></span>
            </label>
            <span class="absolute bottom-full mb-2 left-1/2 -translate-x-1/2 rounded bg-gray-800 text-white text-xs px-2 py-1 opacity-0 group-hover:opacity-100 transition-opacity" data-i18n="themeToggle">Light / Dark Mode</span>
        </div>
        <button id="logoutBtnConsejo" class="bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 transition-colors" data-i18n="logout">
            Cerrar Sesi√≥n
        </button>
    </nav>
</header>

<section class="container mx-auto mt-8 px-4">
    <div class="flex flex-wrap gap-3 justify-center">
        <button class="category-btn bg-blue-100 text-blue-700 px-4 py-2 rounded-md hover:bg-blue-200 transition" data-category="ahorro" data-i18n="categories.saving">Ahorro</button>
        <button class="category-btn bg-green-100 text-green-700 px-4 py-2 rounded-md hover:bg-green-200 transition" data-category="inversion" data-i18n="categories.investment">Inversi√≥n</button>
        <button class="category-btn bg-yellow-100 text-yellow-700 px-4 py-2 rounded-md hover:bg-yellow-200 transition" data-category="presupuesto" data-i18n="categories.budget">Presupuesto</button>
        <button class="category-btn bg-purple-100 text-purple-700 px-4 py-2 rounded-md hover:bg-purple-200 transition" data-category="otros" data-i18n="categories.other">Otros</button>
        <a href="consejo_personalizado.html" class="ml-2 text-white bg-indigo-600 px-4 py-2 rounded-md hover:bg-indigo-700 transition" data-i18n="personalized">Personalizado</a>
    </div>
</section>

<section class="container mx-auto mt-8 px-4">
    <div id="recsWrapper" class="mb-6">
        <h2 class="text-2xl font-semibold mb-3" data-i18n="personalizedRecommendations">Recomendaciones Personalizadas</h2>
        <div id="recsContainer" class="grid md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
        <p id="recsEmpty" class="text-center text-gray-500 mt-4 hidden" data-i18n="noRecommendations">No hay recomendaciones disponibles.</p>
    </div>
    <div id="contentContainer" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
    <p id="emptyMessage" class="text-center text-gray-500 mt-6 hidden" data-i18n="noContent">No hay contenido en esta categor√≠a a√∫n.</p>
</section>

<!-- Modal para art√≠culos -->
<div id="modalArticulo" class="modal">
    <div class="modal-content">
        <span class="close-modal">&times;</span>
        <h2 id="modalTitulo" class="text-xl font-bold mb-3"></h2>
        <div id="modalImagenContainer" class="mb-3 flex justify-center"></div>
        <p id="modalTexto" class="text-gray-700"></p>
    </div>
</div>

<footer class="text-center mt-8 mb-4 text-gray-500">
    &copy; 2025 <span data-i18n="app.name">FinSave</span>. <span data-i18n="allRightsReserved">Todos los derechos reservados.</span>
</footer>

<script>
    // Validaci√≥n de sesi√≥n
    const getToken = () => localStorage.getItem("token");
    const clearToken = () => localStorage.removeItem("token");
    document.getElementById("logoutBtnConsejo").addEventListener("click", () => {
        clearToken();
        alert("Sesi√≥n cerrada.");
        window.location.href = "index.html";
    });
    if (!getToken()) {
        alert("Debes iniciar sesi√≥n primero.");
        window.location.href = "index.html";
    }

    // Funci√≥n para obtener contenido traducido
    function getTranslatedContent() {
        const currentLang = localStorage.getItem("lang") || "es";
        return {
            ahorro: [
                {
                    tipo: "articulo",
                    titulo: translations[currentLang]["article.5WaysSave"],
                    texto: translations[currentLang]["article.5WaysSaveText"],
                    imagen: "https://media.gq.com.mx/photos/60a54fafee4372271f0b9327/1:1/w_2000,h_2000,c_limit/AHORRAR.jpg"
                },
                {
                    tipo: "link",
                    titulo: translations[currentLang]["link.savers"],
                    descripcion: translations[currentLang]["link.saversDesc"],
                    link: "https://www.ahorradoras.com/",
                    imagen: "https://images.unsplash.com/photo-1600585154340-be6161a56a0c?auto=format&fit=crop&w=600&q=80"
                },
                {
                    tipo: "podcast",
                    titulo: translations[currentLang]["podcast.dailyFinance"],
                    descripcion: translations[currentLang]["podcast.dailyFinanceDesc"],
                    link: "https://podcasts.apple.com/es/podcast/al-d%C3%ADa-en-finanzas/id1683812662",
                    imagen: "https://44653823.fs1.hubspotusercontent-na1.net/hubfs/44653823/Cuales-son-los-objetivos-de-las-finanzas-corporativas.jpg"
                }
            ],
            inversion: [
                {
                    tipo: "articulo",
                    titulo: translations[currentLang]["article.investSavings"],
                    texto: translations[currentLang]["article.investSavingsText"],
                    imagen: "https://www.bbva.com/wp-content/uploads/2016/08/Fondos-Estrategia-BBVA-Bancomer-portada.-e1485335541719.jpg"
                },
                {
                    tipo: "video",
                    titulo: translations[currentLang]["video.investGuide"],
                    descripcion: translations[currentLang]["video.investGuideDesc"],
                    link: "https://www.youtube.com/watch?v=kR7w5CwyaIA",
                    imagen: "https://images.unsplash.com/photo-1554224154-22dec7ec8818?auto=format&fit=crop&w=600&q=80"
                },
                {
                    tipo: "link",
                    titulo: translations[currentLang]["link.financeEFE"],
                    descripcion: translations[currentLang]["link.financeEFEDesc"],
                    link: "https://www.radio.es/podcast/finanzas-con-efe",
                    imagen: "https://images.unsplash.com/photo-1554224154-22dec7ec8818?auto=format&fit=crop&w=600&q=80"
                }
            ],
            presupuesto: [
                {
                    tipo: "articulo",
                    titulo: translations[currentLang]["article.budgetOrganization"],
                    texto: translations[currentLang]["article.budgetOrganizationText"],
                    imagen: "https://www.microtech.es/hubfs/Fotos%20blog/planificacion_presupuestos.jpg"
                }
            ],
            otros: [
                // Vac√≠o para mostrar el mensaje de "No hay contenido‚Ä¶"
            ]
        };
    }

    const icons = {
        articulo: "üìù",
        video: "üé•",
        podcast: "üéß",
        link: "üîó"
    };

    const contentContainer = document.getElementById("contentContainer");
    const emptyMessage = document.getElementById("emptyMessage");
    const btns = document.querySelectorAll(".category-btn");

    const modal = document.getElementById("modalArticulo");
    const modalTitulo = document.getElementById("modalTitulo");
    const modalTexto = document.getElementById("modalTexto");
    const modalImagenContainer = document.getElementById("modalImagenContainer");
    const closeModal = document.querySelector(".close-modal");
    closeModal.onclick = () => { modal.style.display = "none"; };
    window.onclick = (e) => { if(e.target === modal) modal.style.display = "none"; };

    function actualizarFondo(categoria) {
        document.body.classList.remove(
            "categoria-ahorro",
            "categoria-inversion",
            "categoria-presupuesto",
            "categoria-otros"
        );
        document.body.classList.add(`categoria-${categoria}`);
    }

    function mostrarContenido(categoria) {
        contentContainer.innerHTML = "";
        const contenido = getTranslatedContent();
        const items = contenido[categoria] || [];

        actualizarFondo(categoria);

        btns.forEach(b => { b.classList.remove("active"); });
        document.querySelector(`.category-btn[data-category="${categoria}"]`)?.classList.add("active");

        if (items.length === 0) {
            emptyMessage.classList.remove("hidden");
            return;
        } else {
            emptyMessage.classList.add("hidden");
        }

        items.forEach(item => {
            const card = document.createElement("div");
            card.className = "card-contenido";

            // Dimensiones variables
            if(item.tipo === "articulo") card.classList.add("card-large");
            else if(item.tipo === "video") card.classList.add("card-medium");
            else card.classList.add("card-small");

            card.innerHTML = `
                <div class="text-4xl mb-2">${icons[item.tipo] || "üìò"}</div>
                ${item.imagen ? `<img src="${item.imagen}" alt="${item.titulo}" class="mb-3 rounded-md w-full h-40 object-cover hover:scale-105 transition-transform">` : ""}
                <h3 class="text-lg font-semibold mb-2">${item.titulo}</h3>
                ${item.descripcion ? `<p class="text-gray-600 mb-3">${item.descripcion}</p>` : ""}
            `;

            if(item.tipo === "articulo") {
                card.addEventListener("click", () => {
                    modalTitulo.textContent = item.titulo;
                    modalTexto.textContent = item.texto;
                    modalImagenContainer.innerHTML = item.imagen ? `<img src="${item.imagen}" alt="${item.titulo}" class="rounded-md w-full object-cover">` : "";
                    modal.style.display = "block";
                });
                const hint = document.createElement("p");
                hint.textContent = translations[currentLang]["clickForMore"];
                hint.className = "text-gray-500 text-sm mt-auto";
                card.appendChild(hint);
            } else {
                const linkElem = document.createElement("a");
                linkElem.href = item.link;
                linkElem.target = "_blank";
                linkElem.rel = "noopener noreferrer";
                linkElem.className = "text-blue-600 font-medium hover:underline mt-auto";
                linkElem.textContent = translations[currentLang]["seeMore"];
                card.appendChild(linkElem);
            }

            contentContainer.appendChild(card);
        });
    }

    btns.forEach(btn => {
        btn.addEventListener("click", () => mostrarContenido(btn.dataset.category));
    });

    // Inicializar con la categor√≠a ahorro
    mostrarContenido("ahorro");

    // Funci√≥n para recargar contenido cuando cambie el idioma
    function reloadContentOnLanguageChange() {
        const langSelect = document.getElementById("langSelect");
        if (langSelect) {
            langSelect.addEventListener("change", () => {
                // Recargar el contenido despu√©s de un peque√±o delay para asegurar que las traducciones se han aplicado
                setTimeout(() => {
                    const activeCategory = document.querySelector(".category-btn.active")?.dataset.category || "ahorro";
                    mostrarContenido(activeCategory);
                }, 100);
            });
        }
    }

    // Llamar a la funci√≥n cuando se cargue la p√°gina
    document.addEventListener("DOMContentLoaded", function() {
        reloadContentOnLanguageChange();
    });
</script>

<!-- AGREGAR EL SCRIPT DE TRADUCCIONES -->
<script src="translations.js"></script>
<script src="consejo.js"></script>
</body>
</html>

